{"version":3,"sources":["assets/Icon_location_red.svg","assets/Icon_location_orange.svg","assets/Icon_location_green.svg","assets/Icon_search.svg","assets/img_bg_orange.svg","components/Map/Map.tsx","components/Tab/Tab.tsx","components/SearchInput/SearchInput.tsx","components/SearchBox/SearchBox.tsx","components/HeadImage/HeadImage.tsx","components/PlaceBox/PlaceBox.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["module","exports","Map","allPlace","latitude","longitude","init","zoom","Icon","adult","child","allMask","redIcon","L","iconUrl","iconRed","iconAnchor","orangeIcon","iconOrange","greenIcon","iconGreen","map","useRef","useEffect","position","length","current","center","attribution","addTo","cluster","addLayer","filter","item","geometry","coordinates","forEach","idx","itemPos","pop","minWidth","maxWidth","setLatLng","setContent","name","address","note","phone","updated","adultCount","childCount","mrks","icon","mask_adult","mask_child","bindPopup","on","openPopup","google","document","querySelector","addEventListener","window","open","remove","id","React","memo","isTab","children","click","className","onClick","getValue","reset","parentSearch","useState","inputValue","setInputValue","src","iconSearch","alt","type","value","placeholder","onKeyDown","onChange","e","target","setTab","getTab","isSelect","search","isSearch","setIsSearch","key","tab","setTabs","LeftImage","moment","Date","now","format","day","days","place","setPosition","title","all","maskResultColor","App","location","setLocation","isLoading","setIsLoading","setAllPlace","setIsTab","searchText","setSearchText","start","end","allCount","setAllCount","startY","scrollY","checkIsTop","domRef","setDomRef","filterAllPlace","useMemo","includes","Promise","navigator","geolocation","getCurrentPosition","pos","a","coords","axios","get","then","res","store","data","features","properties","catch","alert","Fragment","color","height","width","timeout","style","bottom","innerWidth","offsetHeight","transitionDuration","ref","dom","onScroll","scrollTop","scrollHeight","onTouchStart","touches","pageY","onTouchMove","onTouchEnd","changedTouches","Boolean","hostname","match","ReactDOM","render","getElementById","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.b26d8e05.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/Icon_location_red.abc33708.svg\";","module.exports = __webpack_public_path__ + \"static/media/Icon_location_orange.359a86cc.svg\";","module.exports = __webpack_public_path__ + \"static/media/Icon_location_green.b0317730.svg\";","module.exports = __webpack_public_path__ + \"static/media/Icon_search.7bf22ceb.svg\";","module.exports = __webpack_public_path__ + \"static/media/img_bg_orange.0a9c376b.svg\";","import React, { useEffect, FunctionComponent, useRef } from 'react';\nimport './Map.scss';\nimport * as L from 'leaflet';\nimport 'leaflet.markercluster';\nimport \"leaflet.markercluster/dist/MarkerCluster.Default.css\";\nimport \"leaflet/dist/leaflet.css\";\nimport iconRed from '../../assets/Icon_location_red.svg';\nimport iconOrange from '../../assets/Icon_location_orange.svg';\nimport iconGreen from '../../assets/Icon_location_green.svg';\n\ninterface Props {\n  allPlace: object[],\n  latitude: number,\n  longitude: number,\n  init: boolean,\n  zoom: number,\n}\n\nconst Map: FunctionComponent<Props> = ({ allPlace, latitude, longitude, init, zoom }) => {\n  const Icon = (adult: number, child: number) => {\n    const allMask = adult + child;\n    const redIcon = L.icon({\n      iconUrl: iconRed,\n      iconAnchor: [25, 15],\n    });\n    const orangeIcon = L.icon({\n      iconUrl: iconOrange,\n      iconAnchor: [25, 15],\n    });\n    const greenIcon = L.icon({\n      iconUrl: iconGreen,\n      iconAnchor: [25, 15],\n    });\n    if (allMask < 50) {\n      return redIcon;\n    } else if (allMask >= 50 && allMask < 200) {\n      return orangeIcon;\n    } else {\n      return greenIcon;\n    }\n  };\n  const map = useRef<any>(null);\n  useEffect(() => {\n    let position = new L.LatLng(latitude, longitude);\n    if (allPlace.length && latitude && longitude) {\n      map.current = L.map('map', {\n        center: position,\n        zoom: zoom,\n      })\n      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n        attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\n      }).addTo(map.current);\n      const cluster = new L.MarkerClusterGroup();\n      map.current.addLayer(cluster);\n      allPlace.filter((item: any) => item.geometry.coordinates[1] > 0 && item.geometry.coordinates[0] > 0).forEach((item: any, idx: number) => {\n        let itemPos = new L.LatLng(item.geometry.coordinates[1], item.geometry.coordinates[0]);\n        const pop = L.popup({\n          minWidth: 209,\n          maxWidth: 209,\n        })\n          .setLatLng(itemPos)\n          .setContent(`\n            <div>\n              <div class='font-bold fz-16 text-333 mb-4'>${item.name}</div>\n              <div class='fz-12 text-left mb-4'>${item.address}</div>\n              <div class='fz-12 text-left mb-4'>營業時間｜${item.note || '無標示'}</div>\n              <div class='fz-12 text-left mb-4'>連絡電話｜${item.phone}</div>\n              <div class='fz-12 text-left text-CCC mb-8'>資訊更新於 ${item.updated}</div>\n              <div class='flex-row mb-8'>\n                <div class='orange mr-8'>成人口罩 ${item.adultCount}個</div>\n                <div class='yellow'>兒童口罩 ${item.childCount}個</div>\n              </div>\n              <div class=\"google google-${idx}\">Google 路線導航</div>\n            </div>\n          `);\n\n        const mrks = L.marker(itemPos, { icon: Icon(item.mask_adult, item.mask_child) });\n        cluster.addLayer(mrks);\n        mrks.bindPopup(pop).on('click', function () {\n          pop.openPopup();\n        }).on('popupopen', () => {\n          const google = document.querySelector(`.google-${idx}`);\n          if (google) {\n            google.addEventListener('click', () => {\n              window.open(`https://www.google.com/maps/search/?api=1&query=${item.geometry.coordinates[1]},${item.geometry.coordinates[0]}`);\n            });\n          }\n        });\n        if (item.geometry.coordinates[1] === latitude && item.geometry.coordinates[0] === longitude && !init) {\n          mrks.openPopup();\n        }\n      })\n    }\n    return () => {\n      if (map.current) {\n        map.current.remove();\n      }\n    }\n  }, [allPlace, latitude, longitude, init, zoom]);\n  return (\n    <div id=\"map\"></div>\n  )\n}\n\nexport default Map;","import React, { FunctionComponent } from 'react';\nimport './Tab.scss';\n\ninterface Props {\n  isTab: boolean,\n  click: any,\n  children: any,\n}\n\nconst Tabs: FunctionComponent<Props> = ({ isTab, children, click }) => {\n  return (\n    <div className={`tab ${isTab ? 'active' : ''}`} onClick={click}>{children}</div>\n  );\n}\n\nexport default React.memo(Tabs, () => false);\n","import React, { FunctionComponent, useState } from 'react';\nimport './SearchInput.scss';\nimport iconSearch from '../../assets/Icon_search.svg';\n\ninterface Props {\n  getValue: any,\n  reset: any,\n  parentSearch: string,\n}\n\nconst SearchInput: FunctionComponent<Props> = ({ getValue, reset, parentSearch }) => {\n  const [inputValue, setInputValue] = useState<string>(parentSearch);\n  const setValue = (e: any) => {\n    setInputValue(e.target.value);\n    reset(e);\n  }\n  return (\n    <div className='input-wrap'>\n      <img src={iconSearch} alt=\"\" className='icon-search' />\n      <input type=\"search\" value={inputValue} className='search' placeholder='搜尋區域 , 地址 , 藥局' onKeyDown={getValue} onChange={setValue}/>\n    </div>\n  );\n}\n\nexport default React.memo(SearchInput, () => true);\n","import React, { FunctionComponent, useState } from 'react';\nimport './SearchBox.scss';\nimport Tabs from '../Tab/Tab';\nimport SearchInput from '../SearchInput/SearchInput';\n\ninterface Props {\n  getTab: any,\n  setTab: any,\n  isSelect: string,\n  search: any,\n  parentSearch: string,\n}\n\nconst SearchBox: FunctionComponent<Props> = ({ setTab, getTab, isSelect, search, parentSearch }) => {\n  const tabGroup: string[] = ['所有口罩', '成人口罩', '兒童口罩'];\n  const [isSearch, setIsSearch] = useState<boolean>(false);\n  const resetSearch = (e:any): void => {\n    let value = e.target.value;\n    if (!value) {\n      search(value);\n      setIsSearch(false);\n    }\n  }\n\n  const getValue = (e: any): void => {\n    let value = e.target.value;\n    if (e.key === 'Enter') {\n      setIsSearch(!!value);\n      search(value);\n    }\n  }\n\n  const setTabs = (tab: string): void => {\n    setTab(tab);\n    getTab(tab);\n  }\n\n  return (\n    <div className={`search-box ${isSearch&&parentSearch ? 'searching-box' : null}`}>\n      <SearchInput parentSearch={parentSearch} getValue={getValue} reset={resetSearch}/>\n      <div className={`tabs ${isSearch&&parentSearch ? 'searching-tabs' : null}`}>\n        {\n          tabGroup.map(tab => <Tabs key={tab} isTab={isSelect === tab} click={() => setTabs(tab)}>{tab}</Tabs>)\n        }\n      </div>\n    </div>\n  );\n}\n\nexport default React.memo(SearchBox, () => false);\n","import React from 'react';\nimport moment from 'moment';\nimport './HeadImage.scss';\n\nimport LeftImage from '../../assets/img_bg_orange.svg';\n\nconst HeadImage = () => {\n  const days = () => {\n    switch (moment().day()) {\n      case 0:\n        return '日';\n      case 1:\n        return '一';\n      case 2:\n        return '二';\n      case 3:\n        return '三';\n      case 4:\n        return '四';\n      case 5:\n        return '五';\n      case 6:\n        return '六';\n      default:\n        break;\n    }\n  }\n  return (\n    <div className='image-wrapper'>\n      <img src={LeftImage} alt=\"\" />\n      <div>{moment(Date.now()).format('YYYY - MM - DD')}</div>\n      <div>星期{days()}</div>\n      <div className='flex'>\n        <div className='inline'>身分證末一碼<span>偶數</span>字號者可購買口罩</div>\n      </div>\n      <div>※一週限購一次，每次一人限購兩片</div>\n    </div>\n  );\n}\n\nexport default React.memo(HeadImage, () => true);;\n","import React, { FunctionComponent } from 'react';\n// import moment from 'moment';\nimport './PlaceBox.scss';\n\ninterface Props {\n  place: any,\n  isSelect: string,\n  setPosition: any,\n}\n\nconst PlaceBox: FunctionComponent<Props> = ({ place, isSelect = '所有口罩', setPosition }) => {\n  const allMask = (): number => {\n    return place.adultCount + place.childCount;\n  }\n\n  const maskResultColor = (adult: number, child: number): string => {\n    const all = adult + child;\n    if (all > 200) {\n      return 'green';\n    } else if (all >= 50 && all < 200) {\n      return 'oranges';\n    } else {\n      return 'red';\n    }\n  }\n\n  return (\n    <div className='place-box' onClick={() => setPosition(place)}>\n      <div className='font-bold fz-16 text-333 mb-4'>{place.title}</div>\n      <div className='mb-4'>{place.address}</div>\n      <div className='fz-12 mb-8'>營業時間｜{place.note || '無標示'}</div>\n      <div className='flex-row'>\n        {\n          (isSelect === '所有口罩' || isSelect === '成人口罩') && place.adultCount > 0 ?\n            <div className='flex-row justify-between orange mr-8'>\n              <div className='text'>成人口罩</div>\n              <div className='text'>{place.adultCount}個</div>\n            </div> : isSelect === '兒童口罩' || allMask() === 0 ? null : <div className='no-mask mr-8'>口罩缺貨中</div>\n        }\n        {\n          (isSelect === '所有口罩' || isSelect === '兒童口罩') && place.childCount > 0 ?\n            <div className='flex-row justify-between yellow'>\n              <div className='text'>兒童口罩</div>\n              <div className='text'>{place.childCount}個</div>\n            </div> : isSelect === '成人口罩' || allMask() === 0 ? null : <div className='no-mask mr-8'>口罩缺貨中</div>\n        }\n        {\n          allMask() === 0 ? <div className='no-mask mr-8'>口罩缺貨中</div> : null\n        }\n      </div>\n      {\n        allMask() > 0 ? <div className={`triangle ${maskResultColor(place.adultCount, place.childCount)}`}></div> : null\n      }\n    </div>\n  );\n}\n\nexport default React.memo(PlaceBox, () => false);\n","import React, { useState, useEffect, useMemo, useRef } from 'react';\nimport './App.scss';\nimport Loader from 'react-loader-spinner';\nimport \"react-loader-spinner/dist/loader/css/react-spinner-loader.css\";\nimport axios from 'axios';\nimport Map from './components/Map/Map';\nimport SearchBox from './components/SearchBox/SearchBox';\nimport HeadImage from './components/HeadImage/HeadImage';\nimport PlaceBox from './components/PlaceBox/PlaceBox';\ninterface iAllPlace {\n  id: string,\n  title: string,\n  address: string,\n  // startTime: number,\n  // endTime: number,\n  adultCount: number,\n  childCount: number,\n}\ninterface iAllCount {\n  start: number,\n  end: number,\n}\ninterface iLocation {\n  latitude: number,\n  longitude: number,\n  init: boolean,\n  zoom: number,\n}\n\nconst App = () => {\n  const [location, setLocation] = useState<iLocation>({\n    latitude: 0,\n    longitude: 0,\n    init: true,\n    zoom: 16,\n  });\n  const [isLoading, setIsLoading] = useState<boolean>(true);\n  const [allPlace, setAllPlace] = useState<iAllPlace[]>([]);\n  const [isTab, setIsTab] = useState<string>('所有口罩');\n  const [searchText, setSearchText] = useState<string>('');\n  const [allCount, setAllCount] = useState<iAllCount>({\n    start: 30,\n    end: 0,\n  });\n  const startY = useRef(0);\n  const scrollY = useRef(0);\n  let checkIsTop = false;\n  const [domRef, setDomRef] = useState<HTMLDivElement | null>();\n\n  /* layout 相關*/\n  const getTab = (tab: string) => {\n    setIsTab(tab);\n  }\n  const filterAllPlace = useMemo(() => {\n    const { start, end } = allCount;\n    if (searchText) {\n      return allPlace.filter(item => item.title.includes(searchText) || item.address.includes(searchText));\n    }\n    if (start && end) {\n      return allPlace.filter((item: any, idx: number) => idx < start && end > idx);\n    }\n    return allPlace.filter((item: any, idx: number) => idx < start);\n  }, [allCount, allPlace, searchText]);\n  const scrolling = (e: any) => {\n    scrollY.current = e.target.scrollTop;\n    if (scrollY.current > 0) {\n      checkIsTop = false;\n    }\n    if (allCount.start > allPlace.length || searchText) return;\n    let top = e.target.scrollTop;\n    let height = e.target.scrollHeight;\n    if (top / height * 100 > 70) setAllCount({ start: allCount.start + 30, end: allCount.end + 30 });\n  }\n  const search = (e: string) => {\n    setSearchText(e);\n  }\n\n  /* map 相關*/\n  const getGeolocation = () => {\n    navigator.geolocation.getCurrentPosition(async (pos) => {\n      setLocation({\n        latitude: pos.coords.latitude,\n        longitude: pos.coords.longitude,\n        init: true,\n        zoom: 16,\n      });\n      setIsLoading(false);\n    });\n  }\n  const getMaskData = () => {\n    setIsLoading(true);\n    axios.get('https://raw.githubusercontent.com/kiang/pharmacies/master/json/points.json').then(res => {\n      let store = res.data.features.map((item: any) => {\n        return {\n          geometry: item.geometry,\n          ...item.properties,\n          title: item.properties.name,\n          adultCount: item.properties.mask_adult,\n          childCount: item.properties.mask_child,\n        };\n      });\n      setAllPlace(store);\n    }).catch(() => {\n      alert('系統發生錯誤，請再重試');\n      setIsLoading(false);\n    });\n  }\n  const setPosition = (e: any) => {\n    setLocation({\n      latitude: e.geometry.coordinates[1],\n      longitude: e.geometry.coordinates[0],\n      init: false,\n      zoom: 18,\n    });\n  }\n\n  /* touch 相關*/\n  const touchStart = (e: any) => {\n    if (e.touches.length === 1) {\n      if (scrollY.current===0) {\n        checkIsTop = true;\n      }\n      if (domRef) {\n        domRef.style.transitionDuration = '0s';\n      }\n      startY.current = e.touches[0].pageY;\n    }\n  }\n  const touchMove = (e: any) => {\n    if (e.touches.length === 1&&checkIsTop) {\n      if (domRef && scrollY.current === 0) {\n        domRef.style.bottom = `-${e.touches[0].pageY - startY.current}px`;\n      }\n    }\n  };\n  const touchEnd = (e: any) => {\n    if (e.changedTouches.length === 1&&checkIsTop) {\n      if (domRef) {\n        domRef.style.transitionDuration = '.5s';\n        if (e.changedTouches[0].pageY - startY.current > domRef.offsetHeight / 3 && scrollY.current === 0) {\n          domRef.style.bottom = `-${domRef.offsetHeight}px`;\n          setSearchText('');\n        } else {\n          domRef.style.bottom = '0px';\n        }\n      }\n    }\n  };\n\n  useEffect(() => {\n    Promise.all([getGeolocation(), getMaskData()]);\n  }, []);\n\n  return (\n    <React.Fragment>\n      {\n        isLoading ?\n          <div className='relative'>\n            <Loader\n              type=\"ThreeDots\"\n              color=\"orange\"\n              height={100}\n              width={100}\n              timeout={3000000}\n            />\n          </div>\n          :\n          <div className=\"App\">\n            <div className=\"left\">\n              <HeadImage />\n              <SearchBox parentSearch={searchText} search={search} setTab={() => setIsTab(isTab)} getTab={getTab} isSelect={isTab} />\n              <div\n                style={{\n                  bottom: `${searchText ? '0px' : window.innerWidth > 960 ? '0px' : `-${domRef?.offsetHeight}px`}`,\n                  transitionDuration: `${searchText ? '.5s' : '0s'}`,\n                }}\n                ref={dom => setDomRef(dom)}\n                className='place-box-wrap'\n                onScroll={scrolling}\n                onTouchStart={touchStart}\n                onTouchMove={touchMove}\n                onTouchEnd={touchEnd}\n              >\n                {\n                  filterAllPlace.length ? filterAllPlace.map(place => <PlaceBox key={place.id} place={place} isSelect={isTab} setPosition={setPosition} />) :\n                    <div className='no-data'>{searchText && !filterAllPlace.length ? '無搜尋資料' : ''}</div>\n                }\n              </div>\n            </div>\n            <div className=\"right\">\n              <Map init={location.init} latitude={location.latitude} longitude={location.longitude} allPlace={allPlace} zoom={location.zoom} />\n            </div>\n          </div>\n      }\n\n\n    </React.Fragment>\n\n  );\n}\n\nexport default App;","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}